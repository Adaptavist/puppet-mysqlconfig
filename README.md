
# MySQLConfig Module
[![Build Status](https://travis-ci.org/Adaptavist/puppet-mysqlconfig.svg?branch=master)](https://travis-ci.org/Adaptavist/puppet-mysqlconfig)

## Overview

The **MySQLConfig** module installs and configures a mysql database on any node where it has been included and at least a trivial database configuration exists in Hiera.

## Configuration

`mysqlconfig::mysql_root_password:`

The root password on Redhat is set to the value of `mysql_root_password` parameter. On Debian the password is set to the randomly generated password chosen by the package manager.

`mysqlconfig::bind_address:` The bind address for mysqld to listen on, defaults to '127.0.0.1'`

`mysqlconfig::custom_mysql_options:` hash of custom options to pass to mysql class

`mysqlconfig::users:` hash of users to pass to mysql class.  At a minimum this must contain the "ensure" and "password" (if you require apassword) elements, however other options are avaliable, see the hiera example below.

`mysqlconfig::grants:` hash of grants to pass to mysql class

`mysqlconfig::max_allowed_packet:` The maximum packet size accepted, defaults to '128M'

`mysqlconfig::mysql_community_yum_name:` The name of the community MySQL Yum Repository RPM package, used on CentOS/RHEL >= 7  systems as they ship with MariaDB, defaults to 'mysql-community-release-el7-5'

`mysqlconfig::mysql_community_yum_url:` The URL of the community MySQL Yum Repository RPM package, used on CentOS/RHEL >= 7  systems as they ship with MariaDB, defaults to 'https://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm'

`mysqlconfig::mysql_community_server:` The name of the community MySQL server package, used on CentOS/RHEL >= 7  systems as they ship with MariaDB, defaults to 'mysql-community-server'

`mysqlconfig::mysql_community_client:` The name of the community MySQL client package, used on CentOS/RHEL >= 7  systems as they ship with MariaDB, defaults to 'mysql-community-client'

`mysqlconfig::create_admin_user_file:` Flag to control if a admin user and a credentials file should be created on RedHat based systems, this replicates the debian-sys-main user and /etc/mysql/debian.cnf file that comes out of the box with Debian/Ubuntu, defaults to true

`mysqlconfig::admin_username:` Name of the admin user to create for ReHat based systems, defaults to 'administrator',

`mysqlconfig::admin_password:` The plaintext password to use for the admin user on RedHat based systems, if set to 'false' then the password is autogenerated

`mysqlconfig::admin_file_location:` Location of the credentials to create on RedHat based systems, defaults to'/etc/mysql/debian.cnf'

`mysqlconfig::init_script_timeout:` The start timeout to set on RedHat systems that use SysVInit (<= 6), setting to 0 removed any custom timeout, defaults to 0,

`mysqlconfig::init_overwrite_file:` The file in which to place a custom start timeout on RedHat systems that use SysVInit (<= 6), defaults to '/etc/sysconfig/mysqld'

`mysqlconfig::selinux_context`  The selinux context for mysql data directories, defaults to 'mysqld_db_t'

`mysqlconfig::semanage_package`  The package which contains semanage, defaults to "policycoreutils-python" on RHEL 
and "policycoreutils" on Debian

`mysqlconfig::datadir:` A custom MySQL data directory location, if not false or "false" and selinux is enabled the 
selinu context set in `mysqlconfig::semanage_package` is applied to the directory, defaults to false

Configuration can be host specific, if that is desired pass the configuration values inside host hash e.g.

```
'avst-stg1':
  mysqlconfig::custom_mysql_options:
    option1: 'value1'
    option2: 'value2'
  mysqlconfig::bind_address: '127.0.0.1'
  mysqlconfig::users:
  'user@host':
     ensure: 'present'
     max_connections_per_hour: '0'
     max_queries_per_hour: '0'
     max_updates_per_hour: '0'
     max_user_connections: '0'
     password_hash: '**PASSWORD**'
  mysqlconfig::grants:
    'user@host':
       options: ['GRANT']
       privileges: ['REPLICATION SLAVE']
       table: '*.*'
```

## Dependencies

This module depends on the following puppet modules:

* MySQL
